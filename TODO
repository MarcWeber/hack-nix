cabal has got some simplifier / views. Have a look at them. Can they be reused?
